<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/7b0af1eaf3.js" crossorigin="anonymous"></script>
    <title>ElectoBuy</title>
    <script>

      var ordercarthistory = window.sessionStorage.getItem("cartlenght");
      var c = sessionStorage.getItem("cart");
      var newcart = JSON.parse(c);
    </script>
    <style>
        body {
    background-color: #39ace7
}

.card {
    border: none;
    background: #eee
}

.search {
    width: 100%;
    margin-bottom: auto;
    margin-top: 20px;
    height: 50px;
    background-color: #fff;
    padding: 10px;
    border-radius: 5px
}

.search-input {
    color: white;
    border: 0;
    outline: 0;
    background: none;
    width: 0;
    margin-top: 5px;
    caret-color: transparent;
    line-height: 20px;
    transition: width 0.4s linear
}

.search .search-input {
    padding: 0 10px;
    width: 100%;
    caret-color: #39ace7;
    font-size: 19px;
    font-weight: 300;
    color: black;
    transition: width 0.4s linear
}

.search-icon {
    height: 34px;
    width: 34px;
    float: right;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    background-color: #39ace7;
    font-size: 10px;
    bottom: 30px;
    position: relative;
    border-radius: 5px
}

.search-icon:hover {
    color: #fff !important
}

a:link {
    text-decoration: none
}

.card-inner {
    position: relative;
    display: flex;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 1px solid rgba(0, 0, 0, .125);
    border-radius: .25rem;
    border: none;
    cursor: pointer;
    transition: all 2s
}

.card-inner:hover {
    transform: scale(1.1)
}

.mg-text span {
    font-size: 12px
}

.mg-text {
    line-height: 14px
}


    </style>
  </head>
  <body>
 

          
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="index.html">ElectoBuy</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item ">
              <a class="nav-link" href="index.html"><i class="fas fa-home"></i> Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><i class="fas fa-history"></i>Order History</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="browsecatalog.html"><i class="far fa-window-restore"></i>Browse Catalog</a>
            </li>
          </ul>
          
          <span class="navbar-text active">
            <a class="nav-link" href="shoppingcart.html"><i class="fas fa-shopping-cart"></i>Order Cart<span id="ordercarthistory" class="badge badge-secondary"></span></a>
          </span><br>
          <span class="navbar-text">
            <a class="nav-link" id="logoutbutton" href="#"><i class="fas fa-sign-out-alt"></i>Sign Out</a>
          </span>
          
        </div>
      </nav>


      <div class="container mt-4">
        <div class="row d-flex justify-content-center">
            <div class="col-md-9">
                <div class="card p-4 mt-3">
                    <h3 class="heading mt-5 text-center">Please Select Store</h3>
                    <div class="d-flex justify-content-center px-5">
                        <select id="listofstores" class="form-select" aria-label="Default select example">
                            <option selected>Open this select menu</option>
                          
                          </select>
                    </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    <div class="row d-flex justify-content-center">
        <div id="hideinitialsearchresultdiv" lass="col-md-6" style="display: none;">
<div id="quicksearch" class="col-md-12" style="margin-top: 20px;">
  <div class="card-inner p-3 d-flex flex-column align-items-center"> <h6></h6>
    <div class="card" style="width: 18rem;">
      <img id="imagesearch" src="" class="card-img-top" alt="...">
      <div class="card-body">
        <h5 id="productname" class="card-title">Card title</h5>
        <h6 id="price" class="card-title">Price</h6>
        <p id="productdescriptionsearch" class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
        <a href="#" id="submitcartbutton" class="btn btn-primary" onclick="addtocartfunction(this.id); return false;" >Add To Cart</a>
      </div>
    </div>
  </div>
</div>
</div>
</div>


      <div class="container mt-4" style="margin-bottom: 20px;">
        <div class="row d-flex justify-content-center">
            <div class="col-md-9 ">
     <table id="usersearchresulttable" class="table table-responsive d-flex justify-content-center">
  <thead>
    <tr>
      <th scope="col">Products</th>
      <th scope="col">Product ID</th>
      <th scope="col">Product Price</th>    
      <th scope="col">Product Total</th>    
    </tr>
  </thead>
  <tbody>
   
  </tbody>
</table>
</div></div></div>

   







  </div>

</div>




      




 <!-- Footer -->
<footer class="bg-dark text-center text-white">
  <!-- Grid container -->
  <div class="container p-4">
    <!-- Section: Social media -->
    <section class="mb-4">
      <!-- Facebook -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.facebook.com" role="button"
        ><i class="fab fa-facebook-f"></i
      ></a>

      <!-- Twitter -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.twitter.com/" role="button"
        ><i class="fab fa-twitter"></i
      ></a>

      <!-- Google -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.google.com/" role="button"
        ><i class="fab fa-google"></i
      ></a>

      <!-- Instagram -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.instagram.com/" role="button"
        ><i class="fab fa-instagram"></i
      ></a>

      <!-- Linkedin -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.linkedin.com/" role="button"
        ><i class="fab fa-linkedin-in"></i
      ></a>

      <!-- Github -->
      <a class="btn btn-outline-light btn-floating m-1" href="https://www.github.com/" role="button"
        ><i class="fab fa-github"></i
      ></a>
    </section>
    <!-- Section: Social media -->


    <!-- Section: Text -->
    <section class="mb-4">
      <p>
        ElectoBuy is an electronic e-commerce store. We work we numerous vendors to deliver our customers high quality products. Our customers are our top priority. ElectoBuy works hard to ensure our customers are satisfied while shopping on our platform.  
      </p>
    </section>
    <!-- Section: Text -->

    <!-- Section: Links -->
    <section class="">
      <!--Grid row-->
      <div class="row">
        

        <!--Grid column-->
        <div class="col-lg-6 col-md-6 mb-4 mb-md-0">
          <h5 class="text-uppercase">Links</h5>

          <ul class="list-unstyled mb-0">
            <li>
              <a href="#!" class="text-white">Forums</a>
            </li>
            <li>
              <a href="#!" class="text-white">Blog</a>
            </li>
            <li>
              <a href="#!" class="text-white">Careers</a>
            </li>
            <li>
              <a href="#!" class="text-white">Acessibility</a>
            </li>
          </ul>
        </div>
        <!--Grid column-->

        <!--Grid column-->
        <div class="col-lg-6 col-md-6 mb-4 mb-md-0">
          <h5 class="text-uppercase">Links</h5>

          <ul class="list-unstyled mb-0">
            <li>
              <a href="#!" class="text-white">Feedback</a>
            </li>
            <li>
              <a href="#!" class="text-white">Privacy Rights</a>
            </li>
            <li>
              <a href="#!" class="text-white">Company Information</a>
            </li>
            <li>
              <a href="#!" class="text-white">Terms & Conditions</a>
            </li>
          </ul>
        </div>
        <!--Grid column-->
      </div>
      <!--Grid row-->
    </section>
    <!-- Section: Links -->
  </div>
  <!-- Grid container -->

  <!-- Copyright -->
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
    Â© 2021 Copyright:
    <a class="text-white" href="https://mdbootstrap.com/">ElectoBuy</a>
  </div>
  <!-- Copyright -->
</footer>
<!-- Footer -->


     
    
      
      

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
   
    <!--function to be sure you are logged in-->
   <script>
      if(sessionStorage.getItem("user_email_logged_in") == null){
       var body = document.getElementsByTagName("body")[0];
       body.style.display = "none"; 
       alert("You have not signed in. You will now be redirected to the login page.");
         window.location.href = "/login.html";
     }
   </script>
   
   <!--function for logout button-->
   <script>
      document.getElementById("logoutbutton").addEventListener("click", e => {
        e.preventDefault();

        alert("You have successfully logged out");
            sessionStorage.clear()
              window.location.replace("login.html")


      })


      document.getElementById("ordercarthistory").innerHTML = window.sessionStorage.getItem("lenght");
    
      
      
    
    </script>
 





<script>
window.onload = function(){
  
    fetch(`/api/stores`)
        .then(response => response.json())
        .then(customer => {
           console.log(customer);
            var x = document.getElementById("listofstores");
            customer.forEach(element => {

                
                    var option = document.createElement("option");
                    option.text = `${element.storePhoneNumber}`;
                    x.add(option);


                
            });
        })
          
    console.log(newcart)
    newcart.forEach(element => {
        console.log(element)
        
        fetch(`/api/products/findproductybyid/${element}`)
                                .then(response => response.json())
                                .then(productname => {
                                    var table = document.getElementById("usersearchresulttable");
                                    
                                    var row = table.insertRow(1);
                                    var cell1 = row.insertCell(0);
                                    var cell2 = row.insertCell(1);
                                    var cell3 = row.insertCell(2);
                                    var cell4 = row.insertCell(3);       
                                    cell1.innerHTML = `${productname.productName}`;
                                    cell2.innerHTML = `${productname.id}`;
                                    cell3.innerHTML = `${productname.productPrice}`;
                                    cell4.innerHTML = "-";
                                
                                   
          
    });
});

          var ordercarthistory = window.sessionStorage.getItem("cartlenght");
          document.getElementById("ordercarthistory").innerHTML = ordercarthistory; 

     

         
     

}

function addtocartfunction(clicked_id){ 
                            fetch(`/api/products/findproductybyid/${clicked_id}`)
                                .then(response => response.json())
                                .then(productname => {
                                    newcart.push(`${productname.id}`)    
                                  ordercarthistory ++
                                  window.sessionStorage.setItem("cartlenght", ordercarthistory)    
                                  document.getElementById("ordercarthistory").innerHTML = ordercarthistory; 
                                  window.sessionStorage.setItem("cart", JSON.stringify(newcart));    
                                })
                               
                                console.log(newcart);
                          }
</script>

 
    
  </body>
</html>